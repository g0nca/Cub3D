# GuiÃ£o para Parsing do cub3D
## 1. ValidaÃ§Ã£o Inicial do Ficheiro
### 1.1 VerificaÃ§Ã£o do Caminho

* Verificar se recebeste exatamente 1 argumento (alÃ©m do nome do programa) âœ…
* Verificar se o argumento nÃ£o Ã© NULL ou string vazia âœ…
* Verificar se o caminho nÃ£o excede PATH_MAX (geralmente 4096) âœ…

### 1.2 VerificaÃ§Ã£o da ExtensÃ£o .cub

* Verificar se o nome termina em ".cub" âœ… 
* **ATENÃ‡ÃƒO:** NÃ£o aceitar apenas ".cub" como nome (mÃ­nimo "a.cub") âœ…
* **ATENÃ‡ÃƒO:** Verificar casos como "map.cub.txt" ou "map.cubb" (nÃ£o devem passar) âœ…
* **ATENÃ‡ÃƒO:** Verificar "map.cub/" (diretÃ³rio com esse nome) âœ…
* Verificar se tem pelo menos 5 caracteres (x.cub) âœ…

### 1.3 VerificaÃ§Ã£o de PermissÃµes e ExistÃªncia

* Verificar se o ficheiro existe (access com F_OK) âœ…
* Verificar se tens permissÃµes de leitura (access com R_OK) âœ…
* Verificar se nÃ£o Ã© um diretÃ³rio (stat + S_ISDIR) âœ…
* Verificar se o ficheiro nÃ£o estÃ¡ vazio (stat + st_size > 0) âœ…

## 2. Leitura do Ficheiro
### 2.1 Abertura e Leitura

* Abrir o ficheiro com open() âœ…
* Ler linha a linha com get_next_line âœ…
* Guardar todas as linhas numa estrutura (array de strings ou lista) âœ…
* Fechar o file descriptor âœ…

### 2.2 Tratamento de Linhas

* Aceitar linhas vazias (apenas whitespace) - âœ…
* Preservar espaÃ§os dentro do mapa - ğŸ§ª
* Remover '\n' do final de cada linha - âœ…
* Verificar se nÃ£o hÃ¡ caracteres estranhos (nÃ£o ASCII ou nÃ£o imprimÃ­veis) - âœ…

## 3. Parsing dos Elementos de ConfiguraÃ§Ã£o
### 3.1 Texturas (NO, SO, WE, EA)

* Verificar se cada elemento aparece exatamente uma vez - âœ…
* Podem aparecer em qualquer ordem - âœ…
* Podem ter espaÃ§os/tabs antes e depois do identificador - âœ…
* Formato: NO ./path/to/texture.xpm ou NO    ./path.xpm - âŒ
* **ATENÃ‡ÃƒO:** Verificar se o caminho da textura existe - âŒ
* **ATENÃ‡ÃƒO:** Verificar permissÃµes de leitura das texturas - âŒ
* **ATENÃ‡ÃƒO:** Verificar extensÃ£o .xpm - âŒ
* **ATENÃ‡ÃƒO:** Verificar se nÃ£o Ã© um diretÃ³rio - âŒ
* **ATENÃ‡ÃƒO:** Rejeitar mÃºltiplos caminhos na mesma linha - âŒ

### 3.2 Cores do ChÃ£o e Teto (F, C)

* Verificar se cada elemento aparece exatamente uma vez - âœ…
* Formato: F 220,100,0 ou F 220, 100, 0 (espaÃ§os opcionais) - âœ…
* **ATENÃ‡ÃƒO:** Cada valor RGB deve estar entre 0 e 255 - âœ…
* **ATENÃ‡ÃƒO:** Devem ser exatamente 3 valores separados por vÃ­rgulas - âœ…
* **ATENÃ‡ÃƒO:** NÃ£o aceitar valores negativos - âœ…
* **ATENÃ‡ÃƒO:** NÃ£o aceitar valores decimais (sÃ³ inteiros) - âœ…
* **ATENÃ‡ÃƒO:** NÃ£o aceitar espaÃ§os a mais ou vÃ­rgulas duplicadas - âœ…
* **ATENÃ‡ÃƒO:** Formato: 255,255,255 nÃ£o 255, 255, 255, (vÃ­rgula extra) - âœ…

### 3.3 Ordem e Posicionamento

* Todos os 6 elementos (NO, SO, WE, EA, F, C) devem aparecer antes do mapa - ğŸ” ğŸ§ª
* Podem ter linhas vazias entre eles - âœ…
* NÃ£o podem estar misturados com o mapa - âœ…
* **ATENÃ‡ÃƒO:** Elementos duplicados devem ser rejeitados - ğŸ” ğŸ§ª

## 4. Parsing do Mapa
### 4.1 IdentificaÃ§Ã£o do Mapa

* O mapa comeÃ§a na primeira linha que contÃ©m caracteres '0', '1', ou posiÃ§Ã£o do jogador - âœ…
* Todas as linhas apÃ³s o inÃ­cio do mapa fazem parte do mapa - âœ…
* **ATENÃ‡ÃƒO:** NÃ£o podem existir linhas vazias no meio do mapa - âœ…
* **ATENÃ‡ÃƒO:** NÃ£o podem existir elementos de config depois do mapa comeÃ§ar - ğŸ” ğŸ§ª

### 4.2 Caracteres VÃ¡lidos

* 0 - espaÃ§o vazio (caminhÃ¡vel) - âœ…
* 1 - parede - âœ…
*   - espaÃ§o (zona fora do mapa) - âœ…
* N, S, E, W - posiÃ§Ã£o e orientaÃ§Ã£o inicial do jogador - âœ…
* **ATENÃ‡ÃƒO:** Qualquer outro caractere Ã© invÃ¡lido - âœ…

### 4.3 ValidaÃ§Ã£o do Jogador

* Deve existir exatamente uma posiÃ§Ã£o inicial do jogador - âŒ
* **ATENÃ‡ÃƒO:** NÃ£o pode haver 0 jogadores - âŒ
* **ATENÃ‡ÃƒO:** NÃ£o pode haver mais de 1 jogador - âŒ
* A posiÃ§Ã£o do jogador deve estar num espaÃ§o vÃ¡lido (nÃ£o numa parede) - âŒ

### 4.4 ValidaÃ§Ã£o das Paredes (Mapa Fechado)

* O mapa deve estar completamente cercado por paredes '1' ou espaÃ§os ' ' - âŒ
* Todos os espaÃ§os '0' e posiÃ§Ã£o do jogador devem estar rodeados por paredes - âŒ
* **ATENÃ‡ÃƒO:** Verificar bordas (primeira/Ãºltima linha, primeira/Ãºltima coluna) - âŒ
* **ATENÃ‡ÃƒO:** Verificar espaÃ§os ' ' no meio do mapa - nÃ£o podem estar adjacentes a '0' ou jogador - âŒ
* **ATENÃ‡ÃƒO:** Usar flood fill ou algoritmo similar para verificar fechamento - âŒ

### 4.5 Formato do Mapa

* O mapa pode ter linhas de tamanhos diferentes (nÃ£o retangular) - âœ…
* Linhas mais curtas sÃ£o preenchidas com espaÃ§os ' ' conceitualmente - âŒ
* **ATENÃ‡ÃƒO:** Verificar que espaÃ§os vazios nÃ£o criam "buracos" no mapa - âŒ
* Mapa deve ter pelo menos 3 linhas e 3 colunas de Ã¡rea jogÃ¡vel - âŒ

## 5. VerificaÃ§Ãµes Extra de SeguranÃ§a
### 5.1 Limites do Mapa

* Verificar tamanho mÃ¡ximo razoÃ¡vel (evitar mapas gigantes) - âŒ
* Verificar que nÃ£o hÃ¡ overflow em cÃ¡lculos de Ã­ndices - âŒ
* Verificar que nÃ£o hÃ¡ inteiros negativos onde nÃ£o deviam existir - âŒ

### 5.2 Memory Leaks

* Garantir que libertas toda a memÃ³ria alocada em caso de erro - âŒ
* Fechar todos os file descriptors abertos - âŒ
* Libertar estruturas parcialmente preenchidas - âŒ

### 5.3 Mensagens de Erro

* Cada tipo de erro deve ter uma mensagem clara - ğŸ”
* Formato: "Error\n" seguido de descriÃ§Ã£o do erro - âœ…
* Usar write() para stderr (fd 2) - âŒ

## 6. Estrutura de Dados Sugerida
### 6.1 Guardar ConfiguraÃ§Ã£o

* Caminhos das 4 texturas (strings) - âœ…
* Cores RGB do chÃ£o (3 ints) - âœ…
* Cores RGB do teto (3 ints) - âœ…

### 6.2 Guardar Mapa

* Array 2D ou lista de strings - âœ…
* Largura e altura do mapa - âœ…
* PosiÃ§Ã£o inicial do jogador (x, y) - âŒ
* OrientaÃ§Ã£o inicial do jogador (N, S, E, W) - âŒ

### 6.3 Flags de ValidaÃ§Ã£o

* Booleanos para verificar se cada elemento foi encontrado - âœ…
* Contador de jogadores encontrados - âŒ

### 7. Ordem de OperaÃ§Ãµes Recomendada

* Validar argumentos do programa - âœ…
* Validar extensÃ£o .cub - âœ…
* Validar permissÃµes e existÃªncia do ficheiro - âœ…
* Ler ficheiro completo para memÃ³ria - âœ…
* Parsear elementos de configuraÃ§Ã£o (NO, SO, WE, EA, F, C) - âœ…
* Validar que todos os elementos estÃ£o presentes - âœ…
* Identificar onde comeÃ§a o mapa - âœ…
* Parsear o mapa linha a linha - âœ…
* Validar caracteres do mapa - âœ…
* Validar jogador (existÃªncia e quantidade) - âŒ
* Validar paredes (mapa fechado) - âŒ
* Validar texturas (ficheiros existem e sÃ£o acessÃ­veis) - âŒ
* Retornar estrutura preenchida ou erro - ğŸ”

* **Done** âœ…
* **In Progress**ğŸ”
* **To Test**ğŸ§ª
* **To do**âŒ

